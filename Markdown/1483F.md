Status: accepted

Problem ID: cf 1483F

Basic Tags: [[data structures]] [[dfs and similar]] [[dsu]] [[string suffix structures]] [[trees]] [[3400]]

Extended Tags: [[答案范围上界]] [[可行性问题转计数]]

Solution:
	容易发现对于每个串 $s_i$ 合法的对 $(i,j)$ 上界是 $O(|s_i|)$ 个
	于是我们考虑先预处理出可能成为答案的 $O(\sum|s_i|)$ 个 $(i,j)$ 对然后去重
	考虑如何去重，这一步需要转计数，即对于串 $s$，备选串 $s_i$ 合法当且仅当 $s_i$ 在 $s$ 中的出现次数 $f_i$ $=$ $s_i$ 在 $s$ 中的 **作为备选串且不被其他备选串覆盖** 的出现次数 $g_i$
	然后 $f_i$ 可以通过 ACAM 维护 fail 树字数和求出
	$g_i$ 可以直接去除被包含串以后直接计数
	$L = \sum|s_i|$，$O(L \log L)$
	
