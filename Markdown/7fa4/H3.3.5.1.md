建线段树，每个节点的值 $=$ 其儿子节点的和，这显然是差分约束

然后每次询问变成 $O(\log n)$ 个节点的差分约束，暴力建 $O(\log n)$ 个新节点差分约束建图

复杂度 $O(nm\log n)$

