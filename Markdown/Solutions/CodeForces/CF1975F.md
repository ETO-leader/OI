[[位运算]] [[DP]] [[数学]] [[分治]]

我们考虑最暴力的暴力，它是 $\Theta(4^n)$ 的.

这个暴力瓶颈是什么呢? 会有很多只有少量位不同的被重复算了很多次.

考虑去优化这个过程.

有

$$
\forall x \in [0,2^{n-1}) \cap N, |S\cap f^{-1}(x+2^{n-1})|=|S\cap f^{-1}(x)|+|n-1 \in S|
$$

所以对于 $n-1 \not \in S$

$$
|S\cap f^{-1}(x)|\in  f^{-1}(x) \cap f^{-1}(x+2^{n-1})
$$

否则

$$

\left(|S \cap f^{-1}(x)| \in f^{-1}(x)\right) \land \left(|S\cap f^{-1}(x)|+1 \in f^{-1}(x + 2^{n-1})\right)

$$
于是可以转化为位运算转移.




