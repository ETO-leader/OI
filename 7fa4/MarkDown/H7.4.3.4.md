# H7.4.3.4

注意到我们可以二分答案 $x$.

于是问题转化为判断 $\left(\sum\limits_i (a'_i-x\cdot b'_i)\right) \ge 0$.

从 $S$ 向每个 $B_i$ 连流量为 $1$，代价为 $0$ 的边.

从每个 $G_i$ 向 $T$ 连流量为 $1$，代价为 $0$ 的边.

从 $B_i$ 向 $G_j$ 连流量为 $1$，代价为 $a_{i,j}-x\cdot b_{i,j}$ 的边.

判断结果为最小费用最大流的 $cost \ge 0$.

时间复杂度为 $\Omicron(费用流复杂度\cdot \log na)$.



