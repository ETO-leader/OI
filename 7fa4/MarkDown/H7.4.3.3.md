# H7.4.3.3

不难发现共振的个数是 $\Theta(n)$ 级别的.

我们先对每个水晶 $u$ 拆点为 $in_u$ 和 $out_u$，中间连 $c_u$ 流量的边.

于是我们可以先找出共振的水晶对 $(a,b,c)$，连接 $(S,in_a)$，$(out_a,in_b)$，$(out_b,in_c)$ 和 $(out_c,T)$，流量均为 $+\infty$.

答案为这个图的最小割,

时间复杂度 $\Omicron(n 个点 kn 条边网络流复杂度)$，$k$ 是常数.

